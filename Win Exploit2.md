# Modes and Levels

Kernel

vs

User


Priviledged 

vs

Unpriveledged

# Windows Access Control Model

![dn486814 7f21d3f5-428c-4830-ab27-2241934161a2(ws 11)](https://github.com/user-attachments/assets/496b7c47-411b-43f5-9c5c-dfb44053e1c7)


Access Tokens

    SID associations and Token associations

Security Descriptors

    DACL

    SACL

    ACEs

# Windows Integrity Mechanism
Integrity Levels

UNTRUSTED

	Anonymous SID access tokens

LOW

	Everyone SID access token (World)

MEDIUM

	Authenticated Users

HIGH

	Administrators

SYSTEM

	System services (LocalSystem, LocalService, NetworkService)


 # UAC

 Always Notify

 Notify me only when programs try to make changes to my computer

 Notify only when programs try to make chnages to my computer(Do Not dim desktop)

 Never notify

# DEMO: Checking UAC Settings

reg query HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System


# AutoElevate Executables

Requested Execution Levels:

	asInvoker

	highestAvailable

Privilege Escalation
	
 	Actions that allow an adversary to obtain a higher level of permissions on a system or network

# Use SysInternals

	net use z: "\\http://live.sysinternals.com" /persistent:yes

 # Privelege Excaltion

 	Obtain higher level permission can be lateral b=not just vertical

# DLL Search Order
## Executables check the following locations (in successive order):

HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\KnownDLLs

The directory the the Application was run from ***

The directory specified in in the C+ function GetSystemDirectory()

The directory specified in the C+ function GetWindowsDirectory()

The current directory


 #  Scheduled Tasks & Services
## Items to evaluate include:

Write Permissions

Non-Standard Locations

Unquoted Executable Paths (NON FACTOR)

Vulnerabilities in Executables

Permissions to Run As SYSTEM



